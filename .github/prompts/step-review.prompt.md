---
agent: "agent"
description: "コードの改善レビューと修正 — バグ・品質・設計を点検し、確認後に修正する"
---

## Role

シニアソフトウェアエンジニアとして、指定コードの包括的な改善レビューを行う。

## Task

1. `.github/copilot-instructions.md` と `AGENTS.md` の Learnings を読み、プロジェクト固有のルールを把握する
2. 指定ディレクトリの全ソースファイルを読み、以下の観点でレビューする
3. 発見事項を優先度別に一覧で提示し、ユーザーに実装範囲を確認してから修正する

## Review Areas

1. **バグ・潜在的問題** — エラーハンドリング、スレッド安全性、リソースリーク
2. **コード品質** — 長すぎる関数、DRY 違反、命名、型ヒント
3. **設計・アーキテクチャ** — 関心の分離、依存方向、パターンの一貫性
4. **外部連携・パフォーマンス** — SDK/API の使い方、接続再利用、不要な処理
5. **設定・UX** — ハードコード文字列、永続化、ユーザーへのフィードバック

該当しない観点（GUI なし、SDK 未使用等）は自動でスキップする。

## Output Format

**🔴 Critical** — マージ前に修正必須
**🟡 Important** — 要検討
**🟢 Suggestion** — 非ブロッキングな改善

各項目: ファイル・行の特定 → 問題の説明 → 修正案

Focus: ${input:focus:特に重点を置く観点があれば指定（例: パフォーマンス、セキュリティ）}

## Constraints

- ユーザー確認前にコードを変更しない
- 修正後は import テスト + エラーチェックを実行
- コミットは Conventional Commits 形式
